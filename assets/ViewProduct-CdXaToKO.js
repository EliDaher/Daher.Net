import{r as m,j as e,q as W,J as P}from"./index-BgjzOHka.js";import{D as q}from"./DashboardLayout-P3XUXwj6.js";import{D as z}from"./DataTable-DgfOsqsb.js";import{a as M,B as w,L as I}from"./button-BrQsrS7q.js";import{X as L,P as B}from"./PopupForm-DcJrxY53.js";import{u as F}from"./index.esm-Dhtil0Dq.js";import{z as C,t as E}from"./index-DUPkLR7_.js";import{F as k}from"./FormInput-jU1o1Mi-.js";import{P as A}from"./plus-Uw6NWjqK.js";import"./house-CzX8uGDh.js";import"./card-BeiAbVYm.js";import"./input-DBlcqyhk.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=M("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=M("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);function V({product:l,onClose:g,onUpdated:y}){const[o,b]=m.useState({name:l.name||"",price:l.price||"",priceCost:l.priceCost||"",priceWolesale:l.priceWolesale||"",category:l.category||"",stock:l.stock||"",description:l.description||"",imageUrl:l.imageUrl||""}),[f,i]=m.useState(!1),u="https://paynet-1.onrender.com",x=c=>{b({...o,[c.target.name]:c.target.value})},j=async c=>{var v,N;c.preventDefault();try{i(!0);const d=await W.put(`${u}/api/product/update-product/${l._id}`,o);y(d.data)}catch(d){P.error(((N=(v=d==null?void 0:d.response)==null?void 0:v.data)==null?void 0:N.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£")}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white w-full max-w-xl rounded-xl p-6 relative",children:[e.jsx("button",{onClick:g,className:"absolute right-4 top-4 text-gray-500 hover:text-black",children:e.jsx(L,{})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Update Product"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx("input",{name:"name",value:o.name,onChange:x,placeholder:"Name",className:"w-full border p-2 rounded"}),e.jsx("input",{name:"price",value:o.price,onChange:x,placeholder:"Price",className:"w-full border p-2 rounded"}),e.jsx("input",{name:"priceCost",value:o.priceCost,onChange:x,placeholder:"Price Cost",className:"w-full border p-2 rounded"}),e.jsx("input",{name:"priceWolesale",value:o.priceWolesale,onChange:x,placeholder:"Price Wholesale",className:"w-full border p-2 rounded"}),e.jsx("input",{name:"category",value:o.category,onChange:x,placeholder:"Category",className:"w-full border p-2 rounded"}),e.jsx("input",{name:"stock",value:o.stock,onChange:x,placeholder:"Stock",className:"w-full border p-2 rounded"}),e.jsx("input",{name:"imageUrl",value:o.imageUrl,onChange:x,placeholder:"Image URL",className:"w-full border p-2 rounded"}),e.jsx("textarea",{name:"description",value:o.description,onChange:x,placeholder:"Description",className:"w-full border p-2 rounded"}),e.jsx(w,{disabled:f,className:"w-full",children:f?e.jsx(I,{className:"h-4 w-4 animate-spin"}):"Update Product"})]})]})})}function R({items:l,setItems:g}){const[y,o]=m.useState(!1),[b,f]=m.useState(""),[i,u]=m.useState(""),x=(a,t)=>{g(n=>n.map(s=>s._id===a?{...s,quantity:Math.max(1,t)}:s))},j=(a,t)=>{g(n=>n.map(s=>s._id===a?{...s,price:Math.max(0,t)}:s))},c=(a,t)=>{g(n=>n.map(s=>s._id===a?{...s,priceCost:Math.max(0,t)}:s))},v=(a,t)=>{g(n=>n.map(s=>s._id===a?{...s,priceWolesale:Math.max(0,t)}:s))},N=a=>{g(t=>t.filter(n=>n._id!==a))},d=l.reduce((a,t)=>a+t.price*t.quantity,0),_=async()=>{var a,t;o(!0),console.log({items:l,total:d,customerName:b,customerPhone:i});try{const n=await W.post("https://paynet-1.onrender.com/api/invoice/create-invoice",{items:l,total:d,customerName:b,customerPhone:i});P.success("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!")}catch(n){console.log(n),P.error(((t=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:t.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©")}finally{o(!1)}};return e.jsxs("div",{className:"border rounded-xl p-4 bg-white shadow-md space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"ðŸ§¾ Ø§Ù„ÙØ§ØªÙˆØ±Ø©"}),l.length===0&&e.jsx("p",{className:"text-gray-500 text-sm",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©"}),e.jsxs("div",{children:[e.jsx("input",{className:"border rounded px-2 py-1 text-sm w-full",value:b,onChange:a=>f(a.target.value),type:"text",required:!0,placeholder:" . . . Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†"}),e.jsx("input",{className:"border rounded px-2 py-1 text-sm w-full my-2",value:i,onChange:a=>u(a.target.value),type:"number",placeholder:" . . . Ø±Ù‚Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†"})]}),l.map(a=>e.jsxs("div",{className:"grid grid-cols-7 gap-3 items-center",children:[e.jsx("span",{className:"col-span-2 font-medium",children:a.name}),e.jsx("input",{type:"number",value:a.price,onChange:t=>j(a._id,Number(t.target.value)),className:"border rounded px-2 py-1 text-sm"}),e.jsx("input",{type:"number",value:a.priceCost,onChange:t=>c(a._id,Number(t.target.value)),className:"border rounded px-2 py-1 text-sm"}),e.jsx("input",{type:"number",value:a.priceWolesale,onChange:t=>v(a._id,Number(t.target.value)),className:"border rounded px-2 py-1 text-sm"}),e.jsx("input",{type:"number",min:1,value:a.quantity,onChange:t=>x(a._id,Number(t.target.value)),className:"border rounded px-2 py-1 text-sm"}),e.jsx(w,{size:"sm",variant:"destructive",onClick:()=>N(a._id),children:e.jsx(D,{className:"h-4 w-4"})})]},a._id)),e.jsxs("div",{className:"flex justify-between border-t pt-3 font-bold",children:[e.jsx("span",{children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:"}),e.jsxs("span",{className:"text-green-600",children:[d.toFixed(2)," $"]})]}),e.jsx("button",{onClick:_,disabled:y,className:`
    w-full font-bold px-4 py-2 rounded mt-4 text-white
    ${y?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}
  `,children:y?"Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©...":"Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©"})]})}const J=C.object({name:C.string().trim().min(2,"Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ø·Ù„ÙˆØ¨"),price:C.coerce.number().positive("Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ ØºÙŠØ± ØµØ§Ù„Ø­"),priceCost:C.coerce.number().positive("Ø³Ø¹Ø± Ø§Ù„ØªÙƒÙ„ÙØ© ØºÙŠØ± ØµØ§Ù„Ø­"),priceWholesale:C.coerce.number().positive("Ø³Ø¹Ø± Ø§Ù„Ø¬Ù…Ù„Ø© ØºÙŠØ± ØµØ§Ù„Ø­"),category:C.string().trim().min(1,"Ø§Ù„ØªØµÙ†ÙŠÙ Ù…Ø·Ù„ÙˆØ¨"),stock:C.coerce.number().int().min(0,"Ø§Ù„ÙƒÙ…ÙŠØ© ØºÙŠØ± ØµØ§Ù„Ø­Ø©"),description:C.string().trim().max(500).optional(),imageUrl:C.string().url("Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© ØºÙŠØ± ØµØ§Ù„Ø­")}).refine(l=>l.price>=l.priceCost,{message:"Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø³Ø¹Ø± Ø§Ù„ØªÙƒÙ„ÙØ©",path:["price"]});function O({isOpen:l,setIsOpen:g,product:y}){var N,d,_,a,t,n,s,h;const[o,b]=m.useState(null),[f,i]=m.useState(!1),{register:u,handleSubmit:x,reset:j,formState:{errors:c}}=F({resolver:E(J),defaultValues:{stock:0}});m.useEffect(()=>{j(y?{...y}:{name:"",price:0,priceCost:0,priceWholesale:0,category:"",stock:0,description:"",imageUrl:""})},[y,j]);const v=async r=>{var p,U;b(null);try{i(!0),await W.post("https://paynet-1.onrender.com/api/product/add",{name:r.name,price:r.price,description:r.description,category:r.category,imageUrl:r.imageUrl,priceCost:r.priceCost,priceWolesale:r.priceWholesale,stock:r.stock}),b({type:"success",text:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­"}),j()}catch(S){const $=((U=(p=S==null?void 0:S.response)==null?void 0:p.data)==null?void 0:U.message)||S.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸";b({type:"error",text:$})}finally{i(!1)}};return e.jsx(B,{isOpen:l,setIsOpen:g,trigger:e.jsx(w,{className:"w-full",children:"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬"}),children:e.jsxs("form",{dir:"rtl",onSubmit:x(v),className:"grid grid-cols-2 gap-3",children:[e.jsx(k,{label:"Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬",type:"text",...u("name"),error:(N=c.name)==null?void 0:N.message}),e.jsx(k,{label:"Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹",type:"number",step:"0.01",...u("price"),error:(d=c.price)==null?void 0:d.message}),e.jsx(k,{label:"Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡",type:"number",step:"0.01",...u("priceCost"),error:(_=c.priceCost)==null?void 0:_.message}),e.jsx(k,{label:"Ø³Ø¹Ø± Ø§Ù„Ø¬Ù…Ù„Ø©",type:"number",step:"0.01",...u("priceWholesale"),error:(a=c.priceWholesale)==null?void 0:a.message}),e.jsx(k,{label:"Ø§Ù„ØªØµÙ†ÙŠÙ",type:"text",...u("category"),error:(t=c.category)==null?void 0:t.message}),e.jsx(k,{label:"Ø§Ù„ÙƒÙ…ÙŠØ©",type:"number",...u("stock"),error:(n=c.stock)==null?void 0:n.message}),e.jsx(k,{label:"Ø§Ù„ÙˆØµÙ",type:"text",...u("description"),error:(s=c.description)==null?void 0:s.message}),e.jsx(k,{label:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©",type:"text",...u("imageUrl"),error:(h=c.imageUrl)==null?void 0:h.message}),e.jsx(w,{className:"col-span-2",type:"submit",disabled:f,children:f?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬"}),o&&e.jsx("p",{className:`text-sm mt-2 ${o.type==="error"?"text-red-500":"text-green-600"}`,children:o.text})]})})}function le(){const[l,g]=m.useState([]),[y,o]=m.useState(null),[b,f]=m.useState(null),[i,u]=m.useState(!1),[x,j]=m.useState([]),[c,v]=m.useState(!1),N=[{key:"name",label:"Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬",sortable:!0},{key:"price",label:"Ø³Ø¹Ø± Ø§Ù„Ù…Ø¨ÙŠØ¹",sortable:!0},{key:"priceCost",label:"Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡",sortable:!0,onlyAdmin:!0},{key:"priceWolesale",label:"Ø³Ø¹Ø± Ø§Ù„Ø¬Ù…Ù„Ø©",sortable:!0,onlyAdmin:!0},{key:"category",label:"Ø§Ù„ØµÙ†Ù"},{key:"stock",label:"Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹"},{key:"description",label:"Ø§Ù„ÙˆØµÙ"},{key:"imageUrl",label:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©"}],d="https://paynet-1.onrender.com",_=async()=>{var s,h;try{const r=await W.get(`${d}/api/product/get-product`);console.log(r.data),g(r.data)}catch(r){console.log(r),P.error(((h=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:h.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù")}};m.useEffect(()=>{_()},[]);const a=async s=>{var h,r;try{if(!window.confirm("Ù‡Ù„ Ø§Ù†Øª Ù…ØªØ§ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬"))return;o(s),await W.delete(`${d}/api/product/delete-product/${s}`),P.success("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­"),g(U=>U.filter(S=>S._id!==s))}catch(p){console.log(p),P.error(((r=(h=p==null?void 0:p.response)==null?void 0:h.data)==null?void 0:r.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù")}finally{o(null)}},t=()=>{i?P.warning("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©"):P.success("ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ù† Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©"),u(!i)},n=s=>{j(h=>h.find(p=>p._id===s._id)?h.map(p=>p._id===s._id?{...p,quantity:p.quantity+1}:p):[...h,{_id:s._id,name:s.name,price:s.price,priceCost:s.priceCost,priceWolesale:s.priceWolesale,quantity:1}])};return e.jsxs(q,{children:[b&&e.jsx(V,{product:b,onClose:()=>f(null),onUpdated:s=>{g(h=>h.map(r=>r._id===s._id?s:r)),f(null)}}),e.jsx("div",{className:"mb-8 p-6 rounded-xl border border-gray-200 bg-white shadow-sm",children:e.jsxs("div",{className:"flex text-right flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ø¨ÙŠØ¹ Ø¨Ø³Ù‡ÙˆÙ„Ø©"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(O,{isOpen:c,setIsOpen:v,product:b}),e.jsxs(w,{variant:"outline",onClick:()=>t(),children:[i?"Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©":"Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø©",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:i?e.jsx("path",{d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{d:"M12 5v14M5 12h14"})})]})]})]})}),e.jsx(z,{title:"Products",description:"All available products",columns:N,data:l,renderRowActions:s=>e.jsx("div",{className:"flex gap-2",children:i?e.jsx(w,{onClick:()=>n(s),size:"sm",className:"bg-green-600 hover:bg-green-700",children:"Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„ÙØ§ØªÙˆØ±Ø©"}):e.jsxs(e.Fragment,{children:[e.jsx(w,{onClick:()=>{f(s),v(!0)},size:"sm",variant:"outline",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx(w,{onClick:()=>f(s),size:"sm",variant:"outline",children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx(w,{onClick:()=>a(s._id),size:"sm",variant:"destructive",disabled:y===s._id,children:y?e.jsx(I,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(D,{className:"h-4 w-4"})})]})})}),i&&e.jsx(R,{items:x,setItems:j})]})}export{le as default};
