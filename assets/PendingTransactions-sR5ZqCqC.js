import{r as a,l as j,j as e}from"./index-BHksyjCu.js";import{D as v}from"./DataTable-Bl9WQFEJ.js";import{D as c}from"./DashboardLayout-847lGXMB.js";import{B as o}from"./button-Bi0Jjsn1.js";import{P as h}from"./PopupForm-CjgNTsoi.js";import{I as k}from"./input-C7U0o132.js";import{c as P,r as S,g as q}from"./invoices-BUZBDLLc.js";import{u as w}from"./useQuery-IvSESfpH.js";import{u as m}from"./useMutation-9JA2Hk6L.js";import"./card-3_EnEgBy.js";import"./house-BbC6Qasz.js";import"./axios-KE4dpIQc.js";import"./index-xsH4HHeE.js";function A(){const[p,i]=a.useState(!1),[f]=a.useState("سبب الغاء العملية"),[l,u]=a.useState(""),[s,b]=a.useState(null),d=j(),{data:y,isLoading:g}=w({queryKey:["pending-table"],queryFn:q}),n=m({mutationFn:t=>P(t),onSuccess:()=>{d.invalidateQueries({queryKey:["pending-table"]})}}),r=m({mutationFn:t=>S(t),onSuccess:()=>{d.invalidateQueries({queryKey:["pending-table"]})}}),x=[{key:"_id",label:"المعرف",sortable:!0,hidden:!0},{key:"landline",label:"الرقم",sortable:!0},{key:"company",label:"الشركة",sortable:!0},{key:"speed",label:"السرعة",sortable:!0},{key:"email",label:"الحساب المرسل",sortable:!0},{key:"amount",label:"المبلغ الواجب دفعه",sortable:!0},{key:"status",label:"حالة العملية",sortable:!0},{key:"createdAt",label:"الوقت",sortable:!0}];return g?e.jsx(c,{children:e.jsx("div",{dir:"rtl",className:"space-y-6 text-center text-lg font-semibold",children:"جارِ تحميل البيانات..."})}):e.jsxs(c,{children:[e.jsx(h,{isOpen:p,setIsOpen:i,title:f,trigger:e.jsx(e.Fragment,{}),children:e.jsx("div",{className:"flex flex-row-reverse gap-2",children:e.jsxs("form",{onSubmit:t=>{t.preventDefault(),s&&(console.log(s),r.mutate({payment:{id:s._id,email:s.email,amount:s.amount},reason:l}),i(!1),u(""))},className:"space-y-4 w-full",children:[e.jsx(k,{dir:"rtl",value:l,onChange:t=>u(t.target.value),type:"text",placeholder:"سبب الرفض (مثال: لا يوجد رصيد)",required:!0}),e.jsx(o,{type:"submit",children:"تأكيد الرفض"})]})})}),e.jsx("div",{dir:"rtl",className:"space-y-6",children:e.jsx(v,{title:"تسديدات معلقة",description:"",columns:x,data:y||[],renderRowActions:t=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"default",size:"sm",onClick:()=>{window.confirm("هل انت متأكد من انهاء العملية")?n.mutate(t._id):console.log("")},disabled:n.isPending,children:n.isPending?"...":"تأكيد"}),e.jsx(o,{variant:"destructive",size:"sm",onClick:()=>{b(t),i(!0)},disabled:r.isPending,children:r.isPending?"...":"رفض"})]})})})]})}export{A as default};
