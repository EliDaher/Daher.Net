import{c as te,r,u as ae,j as e,a as se,P as y,b as C,d as ne,e as T,f as oe}from"./index-BHksyjCu.js";import{u as re,a as ie,c as E,R as ce,I as le,D as de,U as ue}from"./DashboardLayout-847lGXMB.js";import{S as A,C as R}from"./StatsCard-CyeFTsqL.js";import{C as b}from"./ChartContainer-DJo0IuIj.js";import{C as M,a as B,b as I,c as k}from"./card-3_EnEgBy.js";import{g as me}from"./wifi-LQWNa4dc.js";import{g as P,a as fe}from"./balance-DUNTZniG.js";import{L as pe,A as xe,D as ge,d as ve}from"./DatePicker-CiPoTP4k.js";import{D as be}from"./DemoContainer-CNguQbNm.js";import"./button-Bi0Jjsn1.js";import"./house-BbC6Qasz.js";import"./axios-KE4dpIQc.js";import"./index-xsH4HHeE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=te("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var S="Tabs",[je,_e]=se(S,[E]),F=E(),[ye,w]=je(S),_=r.forwardRef((a,n)=>{const{__scopeTabs:i,value:l,onValueChange:s,defaultValue:f,orientation:o="horizontal",dir:p,activationMode:v="automatic",...x}=a,m=re(p),[d,g]=ae({prop:l,onChange:s,defaultProp:f});return e.jsx(ye,{scope:i,baseId:ie(),value:d,onValueChange:g,orientation:o,dir:m,activationMode:v,children:e.jsx(y.div,{dir:m,"data-orientation":o,...x,ref:n})})});_.displayName=S;var L="TabsList",K=r.forwardRef((a,n)=>{const{__scopeTabs:i,loop:l=!0,...s}=a,f=w(L,i),o=F(i);return e.jsx(ce,{asChild:!0,...o,orientation:f.orientation,dir:f.dir,loop:l,children:e.jsx(y.div,{role:"tablist","aria-orientation":f.orientation,...s,ref:n})})});K.displayName=L;var V="TabsTrigger",$=r.forwardRef((a,n)=>{const{__scopeTabs:i,value:l,disabled:s=!1,...f}=a,o=w(V,i),p=F(i),v=H(o.baseId,l),x=O(o.baseId,l),m=l===o.value;return e.jsx(le,{asChild:!0,...p,focusable:!s,active:m,children:e.jsx(y.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":x,"data-state":m?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:v,...f,ref:n,onMouseDown:C(a.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?o.onValueChange(l):d.preventDefault()}),onKeyDown:C(a.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(l)}),onFocus:C(a.onFocus,()=>{const d=o.activationMode!=="manual";!m&&!s&&d&&o.onValueChange(l)})})})});$.displayName=V;var G="TabsContent",U=r.forwardRef((a,n)=>{const{__scopeTabs:i,value:l,forceMount:s,children:f,...o}=a,p=w(G,i),v=H(p.baseId,l),x=O(p.baseId,l),m=l===p.value,d=r.useRef(m);return r.useEffect(()=>{const g=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(g)},[]),e.jsx(ne,{present:s||m,children:({present:g})=>e.jsx(y.div,{"data-state":m?"active":"inactive","data-orientation":p.orientation,role:"tabpanel","aria-labelledby":v,hidden:!g,id:x,tabIndex:0,...o,ref:n,style:{...a.style,animationDuration:d.current?"0s":void 0},children:g&&f})})});U.displayName=G;function H(a,n){return`${a}-trigger-${n}`}function O(a,n){return`${a}-content-${n}`}var Ne=_,Y=K,z=$,W=U;const Ce=Ne,q=r.forwardRef(({className:a,...n},i)=>e.jsx(Y,{ref:i,className:T("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...n}));q.displayName=Y.displayName;const h=r.forwardRef(({className:a,...n},i)=>e.jsx(z,{ref:i,className:T("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...n}));h.displayName=z.displayName;const j=r.forwardRef(({className:a,...n},i)=>e.jsx(W,{ref:i,className:T("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...n}));j.displayName=W.displayName;function Le(){const a=oe(),n=JSON.parse(localStorage.getItem("DaherUser")),[i,l]=r.useState(0),[s,f]=r.useState([]),[o,p]=r.useState([]),[v,x]=r.useState([]),[m,d]=r.useState(""),g=async()=>{const t=await P("");t!=null&&t.success?x(t.BalanceTable):console.error(t)},J=async()=>{const t=await me();t!=null&&t.success?n.role=="dealer"?f(t.customers.filter(c=>c.dealer==="habeb")):f(t.customers):alert((t==null?void 0:t.error)||"فشل جلب البيانات")},Q=async()=>{const t=await fe("");t!=null&&t.success?p(t.BalanceTable):console.log((t==null?void 0:t.error)||"فشل جلب البيانات"),console.log(t)};r.useEffect(()=>{J(),Q(),g()},[]);const X=r.useMemo(()=>s.reduce((t,c)=>t+Number(c.SubscriptionSpeed),0),[s]),Z=r.useMemo(()=>{const t=s.filter(c=>c.Balance<0).reduce((c,u)=>c+Number(u.Balance),0);return Math.abs(t)},[s]);return r.useEffect(()=>{let t=0;o.forEach(c=>{t+=c.total}),l(t)},[o]),e.jsx(de,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Welcome back! Here's what's happening with your business today."})]}),e.jsxs("div",{dir:"rtl",className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(A,{onClick:()=>{a("/users")},title:"عدد مشتركين الفضائي",value:s.length||0,icon:ue}),e.jsx(A,{onClick:()=>{a("/users",{state:"unpaid"})},title:"الفواتير الغير مدفوعة",value:Z||0,icon:R})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 text-center",children:[e.jsx(b,{className:"mdL:col-span-2",title:" توزع المرسلات ",data:s.reduce((t,c)=>{const u=(c.sender??"").trim(),D=Number(c.SubscriptionSpeed),N=t.find(ee=>ee.sender===u);return N?(N.totalSpeed+=D,N.customerCount+=1):t.push({sender:u,totalSpeed:D,customerCount:1}),t},[]),type:"bar",dataKey2:"customerCount",dataKey:"totalSpeed"}),n.role!="admin"?e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{children:e.jsx(b,{title:"صناديق اليوم",data:o,type:"line",dataKey2:"count",desc:i.toString(),dataKey:"total"})}),e.jsx(b,{title:"عدد المشتركين حسب السرعة",type:"pie",dataKey:"value",data:Object.values(s.reduce((t,c)=>{const u=c.SubscriptionSpeed||"غير محددة";return t[u]||(t[u]={name:`${u} Mbps`,value:0}),t[u].value+=1,t},{})),desc:X.toString()+" Mbps"})]}),n.role!="admin"?e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{children:e.jsxs(Ce,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(q,{children:[e.jsx(h,{value:"overview",children:"Overview"}),e.jsx(h,{value:"analytics",children:"Analytics"}),e.jsx(h,{value:"reports",children:"Reports"})]}),e.jsx(j,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(M,{children:[e.jsxs(B,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(I,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(he,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"2,350"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+180.1% from last month"})]})]}),e.jsxs(M,{children:[e.jsxs(B,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(I,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"$45,231.89"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+20.1% from last month"})]})]}),e.jsx(b,{title:"Revenue Distribution",data:(s==null?void 0:s.slice(0,4))||[],type:"pie",dataKey:"revenue"})]})}),e.jsx(j,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsx("div",{className:"bg-background/80 text-foreground",children:e.jsx(pe,{dateAdapter:xe,children:e.jsx(be,{components:["DatePicker","DatePicker","DatePicker"],children:e.jsx(ge,{views:["month","year"],value:ve(m),onChange:t=>{const c=t.format("YYYY-MM");d(c),P(c).then(u=>{u!=null&&u.success&&x(u.BalanceTable)})}})})})}),e.jsx(b,{title:"صناديق الشهر الحالي",data:v||[],type:"stackBar",dataKey:"users"})]})}),e.jsx(j,{value:"reports",className:"space-y-4",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Reports Coming Soon"}),e.jsx("p",{className:"text-muted-foreground",children:"Advanced reporting features will be available soon."})]})})]})})]})})}export{Le as default};
