import{r as s,e as v,f as P,j as e,J as c}from"./index-BgjzOHka.js";import{D as N}from"./DataTable-DgfOsqsb.js";import{D as y}from"./DashboardLayout-P3XUXwj6.js";import{B as l}from"./button-BrQsrS7q.js";import{P as S}from"./PopupForm-DcJrxY53.js";import{d as C,e as D,f as F}from"./invoices-Cn0FCuk6.js";import{u as f}from"./useMutation-b-dUq8l8.js";import"./card-BeiAbVYm.js";import"./input-DBlcqyhk.js";import"./house-CzX8uGDh.js";function z(){const[b,r]=s.useState(!1),[p]=s.useState("تأكيد الدفعة"),[a,x]=s.useState(null),[o,m]=s.useState(!1),u=v(),i=f({mutationFn:({id:t,email:h,amount:k})=>C(t,h,k),onSuccess:()=>{u.invalidateQueries({queryKey:["payment-table"]})}}),n=f({mutationFn:t=>D(t),onSuccess:()=>{u.invalidateQueries({queryKey:["payment-table"]}),c.success("تم حذف الدفعة بنجاح.")},onError:()=>{c.error("حدث خطأ أثناء حذف الدفعة.")}}),{data:d,isLoading:g}=P({queryKey:["payment-table"],queryFn:F}),j=[{key:"_id",label:"المعرف",sortable:!0,hidden:!0},{key:"destination",label:"الوجهة",sortable:!0},{key:"name",label:"الاسم",sortable:!0},{key:"number",label:"الرقم",sortable:!0},{key:"operator",label:"العملية",sortable:!0},{key:"amount",label:"المبلغ",sortable:!0},{key:"noticeNumber",label:"ملاحظة",sortable:!0},{key:"date",label:"التاريخ",sortable:!0},{key:"isConfirmed",label:"الحالة",sortable:!0},{key:"createdAt",label:"تاريخ العملية",sortable:!0}];return g?e.jsx(y,{children:e.jsx("div",{dir:"rtl",className:"space-y-6 text-center text-lg font-semibold",children:"جارِ تحميل البيانات..."})}):e.jsxs(y,{children:[e.jsx(S,{isOpen:b,setIsOpen:r,title:p,trigger:e.jsx(e.Fragment,{}),children:e.jsx("div",{className:"flex flex-row-reverse gap-2",children:e.jsxs("form",{onSubmit:t=>{t.preventDefault(),m(!0),a&&i.mutate({id:a._id,email:a.name,amount:a.amount}),r(!1),m(!1)},className:"space-y-4 w-full",children:[a&&e.jsxs("p",{className:"text-right",children:["هل تريد تأكيد الدفعة بقيمة ",a.amount," للمستخدم ",e.jsx("strong",{className:"text-lg",children:a.name})]}),e.jsx(l,{disabled:!!o,type:"submit",children:o?"تأكيد قبول الدفعة":"جاري التأكيد"})]})})}),e.jsx("div",{dir:"rtl",className:"space-y-6",children:e.jsx(N,{title:"دفعات نقاط البيع",description:"",columns:j,data:d||[],renderRowActions:t=>e.jsxs(e.Fragment,{children:[e.jsx(l,{disabled:!!i.isPending,variant:t.isConfirmed?"default":"secondary",className:"capitalize",onClick:()=>{x(t),r(!0)},children:i.isPending?"...":t.isConfirmed?"تم التأكيد":"بحاجة الى تأكيد"}),e.jsx(l,{className:"capitalize",variant:"destructive",disabled:n.isPending,onClick:()=>{window.confirm("هل أنت متأكد من حذف هذه الدفعة؟")&&n.mutate(t._id)},children:n.isPending?"جاري الحذف...":"حذف الدفعة"})]})})})]})}export{z as default};
