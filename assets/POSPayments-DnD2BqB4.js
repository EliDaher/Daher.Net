import{r as s,h as k,i as v,j as e}from"./index-CJDeOR-D.js";import{D as P}from"./DataTable-BowkCNWE.js";import{D as c}from"./DashboardLayout-y2KXrlW2.js";import{B as l}from"./button-By_xk0nu.js";import{P as N}from"./PopupForm-wiHTllH-.js";import{d as S,e as C,f as D}from"./invoices-DscnKQao.js";import{u as y}from"./useMutation-WFqE7oBj.js";import"./card-CHhuJT8d.js";import"./input-GrzhRsEd.js";import"./house-CfMLYBxw.js";function _(){const[b,r]=s.useState(!1),[f]=s.useState("تأكيد الدفعة"),[a,p]=s.useState(null),[o,m]=s.useState(!1),u=k(),i=y({mutationFn:({id:t,email:h,amount:j})=>S(t,h,j),onSuccess:()=>{u.invalidateQueries({queryKey:["payment-table"]})}}),n=y({mutationFn:t=>C(t),onSuccess:()=>{u.invalidateQueries({queryKey:["payment-table"]}),alert("تم حذف الدفعة بنجاح.")},onError:()=>{alert("حدث خطأ أثناء حذف الدفعة.")}}),{data:d,isLoading:x}=v({queryKey:["payment-table"],queryFn:D}),g=[{key:"_id",label:"المعرف",sortable:!0,hidden:!0},{key:"destination",label:"الوجهة",sortable:!0},{key:"name",label:"الاسم",sortable:!0},{key:"number",label:"الرقم",sortable:!0},{key:"operator",label:"العملية",sortable:!0},{key:"amount",label:"المبلغ",sortable:!0},{key:"noticeNumber",label:"ملاحظة",sortable:!0},{key:"date",label:"التاريخ",sortable:!0},{key:"isConfirmed",label:"الحالة",sortable:!0},{key:"createdAt",label:"تاريخ العملية",sortable:!0}];return x?e.jsx(c,{children:e.jsx("div",{dir:"rtl",className:"space-y-6 text-center text-lg font-semibold",children:"جارِ تحميل البيانات..."})}):e.jsxs(c,{children:[e.jsx(N,{isOpen:b,setIsOpen:r,title:f,trigger:e.jsx(e.Fragment,{}),children:e.jsx("div",{className:"flex flex-row-reverse gap-2",children:e.jsxs("form",{onSubmit:t=>{t.preventDefault(),m(!0),a&&i.mutate({id:a._id,email:a.name,amount:a.amount}),r(!1),m(!1)},className:"space-y-4 w-full",children:[a&&e.jsxs("p",{className:"text-right",children:["هل تريد تأكيد الدفعة بقيمة ",a.amount," للمستخدم ",e.jsx("strong",{className:"text-lg",children:a.name})]}),e.jsx(l,{disabled:!!o,type:"submit",children:o?"تأكيد قبول الدفعة":"جاري التأكيد"})]})})}),e.jsx("div",{dir:"rtl",className:"space-y-6",children:e.jsx(P,{title:"دفعات نقاط البيع",description:"",columns:g,data:d||[],renderRowActions:t=>e.jsxs(e.Fragment,{children:[e.jsx(l,{disabled:!!i.isPending,variant:t.isConfirmed?"default":"secondary",className:"capitalize",onClick:()=>{p(t),r(!0)},children:i.isPending?"...":t.isConfirmed?"تم التأكيد":"بحاجة الى تأكيد"}),e.jsx(l,{className:"capitalize",variant:"destructive",disabled:n.isPending,onClick:()=>{window.confirm("هل أنت متأكد من حذف هذه الدفعة؟")&&n.mutate(t._id)},children:n.isPending?"جاري الحذف...":"حذف الدفعة"})]})})})]})}export{_ as default};
